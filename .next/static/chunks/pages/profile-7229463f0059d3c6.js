(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{1265:(e,a,l)=>{"use strict";l.d(a,{A:()=>d});var t=l(7876),s=l(4232),r=l(8230),i=l.n(r);l(8519);var n=l(6460),c=l(8581);let o=function(){let[e,a]=(0,s.useState)(null),[l,r]=(0,s.useState)(null),[i,o]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[u,h]=(0,s.useState)("/images/userprofile.png"),[p,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let a=JSON.parse(e),l=null==a?void 0:a.user,t=null==a?void 0:a.type;(null==l?void 0:l.id)&&"user"===t?(f(l.id),v(l.id)):console.warn("User type is not 'user' or ID is missing")}},[]);let v=async e=>{try{let l=localStorage.getItem("token"),t=await (0,c.W)("".concat(n.v.base_url,"users/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(l)}}),s=await t.json();if(t.ok&&s.data){let e=s.data.image||"/images/userprofile.png";h(e),a(s.data)}}catch(e){console.error("Error fetching user:",e)}},g=async()=>{if(!l||!p)return;let e=new FormData;e.append("image",l);try{let a=localStorage.getItem("token"),l=await (0,c.W)("".concat(n.v.base_url,"users/upload-profile/").concat(p),{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:e}),t=await l.json();if(l.ok&&t.status){let e=t.data||"/images/userprofile.png";h("".concat(e,"?").concat(Date.now())),r(null)}else o(t.message||"Upload failed. Try again."),m("error")}catch(e){console.error("Upload error:",e),alert("Something went wrong while uploading.")}};return(0,t.jsxs)("div",{className:"text-center user-photo",children:[(0,t.jsxs)("div",{className:"position-relative d-inline-block",children:[(0,t.jsx)("img",{src:u,className:"rounded-circle profile-pic img-thumbnail",alt:"Profile",width:"120",height:"120"}),(0,t.jsx)("label",{htmlFor:"upload-photo",className:"btn btn-primary btn-sm position-absolute bottom-0 end-0 rounded-circle",title:"Change Photo",style:{cursor:"pointer"},children:(0,t.jsx)("i",{className:"fas fa-camera"})}),(0,t.jsx)("input",{type:"file",id:"upload-photo",accept:"image/*",onChange:e=>{var a;let l=null==(a=e.target.files)?void 0:a[0];if(l){if(l.size/1024>50){o("Image size should be 50KB or less."),m("error"),r(null);return}r(l),h(URL.createObjectURL(l))}},style:{display:"none"}})]}),(0,t.jsxs)("div",{className:"mt-2",children:[i&&(0,t.jsx)("p",{style:{color:"success"===d?"green":"red",fontSize:"0.75rem",margin:0},children:i}),!i&&l&&(0,t.jsx)("button",{className:"btn btn-success btn-sm",style:{fontSize:"0.75rem",padding:"2px 8px"},onClick:()=>g(l),children:"Upload"})]}),(0,t.jsxs)("p",{className:"mt-2 mb-1 profile-name fw-bold",children:[null==e?void 0:e.first_name," ",null==e?void 0:e.last_name]}),(0,t.jsxs)("p",{className:"text-muted mb-3 profile-number",children:["(+91 ",null==e?void 0:e.mobile,")"]})]})},d=function(){return(0,t.jsx)("div",{className:"p-4 pt-0 Sidebar",children:(0,t.jsxs)("div",{className:"nav flex-column nav-pills leftbar",children:[(0,t.jsx)("div",{className:"profile-ph-part",children:(0,t.jsx)(o,{})}),(0,t.jsxs)("div",{className:"left-menu py-3",children:[(0,t.jsx)(i(),{className:"nav-link border-bottom",href:"/profile",children:"Personal Info"}),(0,t.jsx)(i(),{className:"nav-link border-bottom",href:"/wallet-transation",children:"Wallet Transation"}),(0,t.jsx)(i(),{className:"nav-link border-bottom d-flex justify-content-between align-items-center",href:"/wallet-recharge",children:"Wallet Recharge"})]})]})})}},2080:e=>{e.exports={"sectiontop-margin":"profile_sectiontop-margin___gn0x","profile-sidebar":"profile_profile-sidebar__NoRAm","nav-pills":"profile_nav-pills__mVefA","nav-link":"profile_nav-link__ZUk2D",active:"profile_active__ntArF","profile-pic":"profile_profile-pic__hAwfV","settings-card":"profile_settings-card__4SB_Q","form-switch":"profile_form-switch__KANOa","form-check-input":"profile_form-check-input__awxpS","activity-item":"profile_activity-item__OelWY","profile-name":"profile_profile-name__FBvEO","profile-number":"profile_profile-number__6Wvsn","bg-title-profile":"profile_bg-title-profile__I0MKJ","bg-profile":"profile_bg-profile__48GX8","Update-btn":"profile_Update-btn__HRct0",textDanger:"profile_textDanger__eNSt0",small:"profile_small__qOuPl",readonlySelect:"profile_readonlySelect__VgiqF",alertSuccess:"profile_alertSuccess__wOL4F",alertError:"profile_alertError__M6zRi",fadeUp:"profile_fadeUp__LKcHS",fadeInUp:"profile_fadeInUp__Okvhh",centeredMessage:"profile_centeredMessage__q1n0b"}},3162:(e,a,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return l(3466)}])},3466:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>p});var t=l(7876),s=l(432),r=l(2080),i=l.n(r),n=l(1265),c=l(4232),o=l(6460),d=l(1408),m=l(8581),u=l(9593);let h=function(){let[e,a]=(0,c.useState)({country:"",state:"",city:"",first_name:"",last_name:"",email:"",mobile:"",topic_of_concern:"",gender:"",birth_time:"",birth_date:"",marital_status:"",birth_place:"",pincode:"",religion:"",language:"",occupation:""}),[l,s]=(0,c.useState)([]),[r,n]=(0,c.useState)([]),[h,p]=(0,c.useState)([]),[f,v]=(0,c.useState)([]),[g,x]=(0,c.useState)([]),[j,_]=(0,c.useState)([]),[b,N]=(0,c.useState)(""),[y,S]=(0,c.useState)(""),[F,w]=(0,c.useState)(""),[E,T]=(0,c.useState)(null),[C,q]=(0,c.useState)(null),k=(0,u.Wx)({initialValues:{mobile:"",city:""}});(0,c.useEffect)(()=>{var e;let l=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("user")),s=null==t?void 0:t.user.id,r=null==t?void 0:t.type;if(w((null==t||null==(e=t.user)?void 0:e.mobile)||""),!s||!r)return void console.error("Missing userId or userType");(async()=>{try{if("user"===r){let e=await (0,m.W)("".concat(o.v.base_url,"users/").concat(s),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)}}),t=await e.json();console.log("response data user",t),a(t.data),k.setValues(e=>({...e,mobile:t.mobile||"",city:t.city||""}))}}catch(e){console.error("Error fetching profile:",e)}})()},[]);let O=async()=>{try{let[e,a]=await Promise.all([(0,m.W)("".concat(o.v.base_url,"countries/countries")).then(e=>e.json()),(0,m.W)("".concat(o.v.base_url,"countries/config")).then(e=>e.json())]);s(e.data),v(a.data.religion),x(a.data.language),_(a.data.occupation)}catch(e){console.error("Error loading dropdown data:",e)}};(0,c.useEffect)(()=>{O()},[]),(0,c.useEffect)(()=>{if(l.length>0){let e=l.find(e=>"India"===e.name);e&&(a(a=>({...a,country:e.name})),T(e.id),V(e.id))}},[l]),(0,c.useEffect)(()=>{if(r.length>0&&e.state){var a;let l=null==(a=r.find(a=>a.name===e.state))?void 0:a.id;l&&(q(l),D(l))}},[r,e.state]);let V=async e=>{try{let a=await (0,m.W)("".concat(o.v.base_url,"countries/states/").concat(e)).then(e=>e.json());n(a.data),p([]),q(null)}catch(e){console.error("Error loading states:",e)}},D=async e=>{try{let a=await (0,m.W)("".concat(o.v.base_url,"countries/cities/").concat(e)).then(e=>e.json());p(a.data)}catch(e){console.error("Error loading cities:",e)}},P=d.Ik().shape({first_name:d.Yj().required("First name is required"),last_name:d.Yj().required("Last name is required"),email:d.Yj().email("Invalid email format").required("Email is required"),birth_place:d.Yj().required("Birth place is required"),birth_date:d.Yj().required("Date of birth is required"),gender:d.Yj().required("Gender is required"),state:d.Yj().required("State is required"),city:d.Yj().required("City is required"),pincode:d.Yj().matches(/^\d{6}$/,"Pincode must be exactly 6 digits").required("Pincode is required"),marital_status:d.Yj().required("Marital Status is required"),religion:d.Yj().required("Religion is required"),language:d.Yj().required("Language is required")}),I=async e=>{let a=localStorage.getItem("token"),l=JSON.parse(localStorage.getItem("user")),t=null==l?void 0:l.user.id;if(e.pincode&&(e.pincode=Number(e.pincode)),!t)return void console.error("User ID not found");let{image:s,id:r,mobile:i,is_active:n,is_login:c,...d}=e;try{let e=await (0,m.W)("".concat(o.v.base_url,"users/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(d)}),l=await e.json();e.ok&&l.status?(N(l.message||"Profile updated successfully!"),S("success")):(N(l.message||"Profile update failed. Please try again."),S("error")),setTimeout(()=>{N(""),S("")},3e3)}catch(e){console.error("API error:",e),N("An error occurred. Please try again."),S("error"),setTimeout(()=>{N(""),S("")},3e3)}};return(0,t.jsxs)("div",{className:"user-profile-info p-4 pt-0",children:[(0,t.jsx)("h5",{className:"mb-4 bg-title-profile",children:"Edit Profile"}),b&&(0,t.jsx)("div",{className:i().centeredMessage,children:(0,t.jsx)("div",{className:"".concat(i().fadeUp," ").concat("success"===y?i().alertSuccess:i().alertError),children:b})}),(0,t.jsx)(u.l1,{initialValues:e,enableReinitialize:!0,validationSchema:P,onSubmit:I,children:e=>(0,t.jsx)("form",{onSubmit:e.handleSubmit,children:(0,t.jsx)("div",{className:"card shadow-sm p-3 bg-profile",children:(0,t.jsx)("div",{className:"p-4 px-0",children:(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsxs)("div",{className:"row g-3",children:[(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",style:{fontWeight:500},children:"First name"}),(0,t.jsx)("input",{name:"first_name",className:"form-control",value:e.values.first_name,placeholder:"Enter first name",onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)}}),e.errors.first_name&&e.touched.first_name&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.first_name})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Last name"}),(0,t.jsx)("input",{name:"last_name",className:"form-control",value:e.values.last_name,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},placeholder:"Enter last name"}),e.errors.last_name&&e.touched.last_name&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.last_name})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Email"}),(0,t.jsx)("input",{type:"email",name:"email",className:"form-control",value:e.values.email,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},placeholder:"Enter email-Id"}),e.errors.email&&e.touched.email&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.email})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Date of birth"}),(0,t.jsx)("input",{type:"date",name:"birth_date",className:"form-control",value:e.values.birth_date?e.values.birth_date.slice(0,10):"",onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)}}),e.errors.birth_date&&e.touched.birth_date&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.birth_date})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Time of birth"}),(0,t.jsx)("input",{type:"time",name:"birth_time",className:"form-control",value:e.values.birth_time,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1)}})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Gender"}),(0,t.jsxs)("select",{name:"gender",className:"form-select",value:e.values.gender,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},children:[(0,t.jsx)("option",{value:"",children:"Select Gender"}),(0,t.jsx)("option",{value:"FEMALE",children:"Female"}),(0,t.jsx)("option",{value:"MALE",children:"Male"}),(0,t.jsx)("option",{value:"OTHER",children:"Other"})]}),e.errors.gender&&e.touched.gender&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.gender})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Birth Place"}),(0,t.jsx)("input",{type:"text",name:"birth_place",className:"form-control",value:e.values.birth_place,placeholder:"Enter Birth Place",onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)}}),e.errors.birth_place&&e.touched.birth_place&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.birth_place})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Select Country"}),(0,t.jsxs)("select",{name:"country",className:"form-select",value:e.values.country,onChange:a=>{var l,t;let{name:s,value:r}=a.target;e.setFieldValue(s,r),e.setFieldTouched(s,!0,!1),(null==(t=e.validationSchema)||null==(l=t.fields)?void 0:l[s])&&e.validateField(s)},disabled:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Country"}),l.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Select State"}),(0,t.jsxs)("select",{name:"state",className:"form-select",value:e.values.state,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l);let s=r.find(e=>e.name===t);s&&D(s.id)},children:[(0,t.jsx)("option",{value:"",children:"Select State"}),r.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]}),e.errors.state&&e.touched.state&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.state})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Select City"}),(0,t.jsxs)("select",{name:"city",className:"form-select",value:e.values.city,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},children:[(0,t.jsx)("option",{value:"",children:"Select City"}),h.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]}),e.errors.city&&e.touched.city&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.city})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Pincode"}),(0,t.jsx)("input",{type:"number",name:"pincode",className:"form-control",value:e.values.pincode,placeholder:"Enter pincode",onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)}}),e.errors.pincode&&e.touched.pincode&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.pincode})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Marital Status"}),(0,t.jsxs)("select",{name:"marital_status",className:"form-select",value:e.values.marital_status,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},children:[(0,t.jsx)("option",{value:"",children:"Select Marital Status"}),(0,t.jsx)("option",{value:"Single",children:"Single"}),(0,t.jsx)("option",{value:"Married",children:"Married"})]}),e.errors.marital_status&&e.touched.marital_status&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.marital_status})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Religion"}),(0,t.jsxs)("select",{name:"religion",className:"form-select",value:e.values.religion,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},children:[(0,t.jsx)("option",{value:"",children:"Select Religion"}),Object.entries(f||{}).map(e=>{let[a,l]=e;return(0,t.jsx)("option",{value:l,children:l},a)})]}),e.errors.religion&&e.touched.religion&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.religion})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Language"}),(0,t.jsxs)("select",{name:"language",className:"form-select",value:e.values.language,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1),e.validateField(l)},children:[(0,t.jsx)("option",{value:"",children:"Select Language"}),Object.entries(g||{}).map(e=>{let[a,l]=e;return(0,t.jsx)("option",{value:l,children:l},a)})]}),e.errors.language&&e.touched.language&&(0,t.jsx)("div",{className:"".concat(i().textDanger," ").concat(i().small),children:e.errors.language})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Occupation"}),(0,t.jsxs)("select",{name:"occupation",className:"form-select",value:e.values.occupation,onChange:a=>{let{name:l,value:t}=a.target;e.setFieldValue(l,t),e.setFieldTouched(l,!0,!1)},children:[(0,t.jsx)("option",{value:"",children:"Select Occupation"}),Object.entries(j||{}).map(e=>{let[a,l]=e;return(0,t.jsx)("option",{value:l,children:l},a)})]})]}),(0,t.jsxs)("div",{className:"col-md-4",children:[(0,t.jsx)("label",{className:"form-label",children:"Mobile"}),(0,t.jsx)("input",{type:"text",name:"mobile",className:"form-control",value:F,placeholder:"Enter Mobile Number",readOnly:!0})]}),(0,t.jsxs)("div",{className:"col-12",children:[(0,t.jsx)("label",{className:"form-label",children:"Topic of concern"}),(0,t.jsx)("textarea",{name:"topic_of_concern",className:"form-control",rows:"4",value:e.values.topic_of_concern,placeholder:"Write something about yourself...",onChange:a=>{e.setFieldValue("topic_of_concern",a.target.value)}})]}),(0,t.jsx)("div",{className:"col-12",children:(0,t.jsx)("div",{className:"text-center mt-3",children:(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update Profile"})})})]})})})})})})]})};function p(){return(0,s.A)(),(0,t.jsx)("div",{className:"bg-light ",style:{marginTop:"130px"},children:(0,t.jsx)("div",{className:"container-fluid pb-5 pt-0",children:(0,t.jsx)("div",{className:"row",children:(0,t.jsx)("div",{className:"col-12",children:(0,t.jsx)("div",{className:"card border-0 shadow-sm",children:(0,t.jsx)("div",{className:"card-body p-0",children:(0,t.jsxs)("div",{className:"row g-0",children:[(0,t.jsx)("div",{className:"col-lg-3 border-end testClass",children:(0,t.jsx)(n.A,{})}),(0,t.jsx)("div",{className:"col-lg-9",children:(0,t.jsx)(h,{})})]})})})})})})})}},8519:e=>{e.exports={"profile-sidebar":"leftbar_profile-sidebar__3MbSx","nav-pills":"leftbar_nav-pills__2oh5f","nav-link":"leftbar_nav-link__OC8Qo",leftbar:"leftbar_leftbar__aan3a"}}},e=>{e.O(0,[856,636,593,792],()=>e(e.s=3162)),_N_E=e.O()}]);